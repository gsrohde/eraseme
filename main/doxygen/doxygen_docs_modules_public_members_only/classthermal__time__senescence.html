<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: thermal_time_senescence Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classthermal__time__senescence.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classthermal__time__senescence-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">thermal_time_senescence Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Determines senescence rates for several plant organs based on thermal time thresholds and magical time travel; only compatible with a fixed-step Euler solver.  
 <a href="classthermal__time__senescence.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for thermal_time_senescence:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classthermal__time__senescence__inherit__graph.png" border="0" usemap="#athermal__time__senescence_inherit__map" alt="Inheritance graph"/></div>
<map name="athermal__time__senescence_inherit__map" id="athermal__time__senescence_inherit__map">
<area shape="rect" title="Determines senescence rates for several plant organs based on thermal time thresholds and magical tim..." alt="" coords="5,80,180,107"/>
<area shape="rect" title=" " alt="" coords="27,5,158,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for thermal_time_senescence:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classthermal__time__senescence__coll__graph.png" border="0" usemap="#athermal__time__senescence_coll__map" alt="Collaboration graph"/></div>
<map name="athermal__time__senescence_coll__map" id="athermal__time__senescence_coll__map">
<area shape="rect" title="Determines senescence rates for several plant organs based on thermal time thresholds and magical tim..." alt="" coords="5,80,180,107"/>
<area shape="rect" title=" " alt="" coords="27,5,158,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1cbddf8207e8b40e0a53bffc69a1f190"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__senescence.html#a1cbddf8207e8b40e0a53bffc69a1f190">thermal_time_senescence</a> (state_map const &amp;input_quantities, state_map *output_quantities)</td></tr>
<tr class="separator:a1cbddf8207e8b40e0a53bffc69a1f190"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:abc6bcae9586eb99fffb12a684814a4e6"><td class="memItemLeft" align="right" valign="top">static string_vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__senescence.html#abc6bcae9586eb99fffb12a684814a4e6">get_inputs</a> ()</td></tr>
<tr class="separator:abc6bcae9586eb99fffb12a684814a4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eff545285286763183243b1d473e6df"><td class="memItemLeft" align="right" valign="top">static string_vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__senescence.html#a7eff545285286763183243b1d473e6df">get_outputs</a> ()</td></tr>
<tr class="separator:a7eff545285286763183243b1d473e6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0866265cb5b92692af7be0ef011f355"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__senescence.html#ad0866265cb5b92692af7be0ef011f355">get_name</a> ()</td></tr>
<tr class="separator:ad0866265cb5b92692af7be0ef011f355"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Determines senescence rates for several plant organs based on thermal time thresholds and magical time travel; only compatible with a fixed-step Euler solver. </p>
<h3><a class="anchor" id="autotoc_md43"></a>
Model overview</h3>
<p>This module calculates senescence for the following organs:</p><ul>
<li><code>Leaf</code></li>
<li><code>Stem</code></li>
<li><code>Root</code></li>
<li><code>Rhizome</code></li>
</ul>
<p>For a particular organ, senescence begins to occur after the total thermal time passes a threshold value. When this happens for the leaf, some of its mass is lost, with a fraction being remobilized to other organs and the remainder contributing to the litter. The other organs contribute to litter but their tissue is not remobilized.</p>
<p>It is possible for the grain to gain mass that was remobilized from the leaf, although grain senescence is not considered here.</p>
<p>To decide how much mass is being lost, this model looks back in time. For the first timestep after senescence starts, this model assumes that the amount of mass lost is equal to the amount of mass that organ gained during its first timestep of growth. Then, for the second timestep after senescence starts, the organ loses the amount of mass it gained during its second hour of growth. This process is repeated indefinitely.</p>
<p>For some reason, this model does not consider any mass gained due to carbon remoblization or retranslocation; it only considers the net amount of carbon gained through photosynthesis.</p>
<p>There are some problems with this type of senescence model:</p><ul>
<li>In reality, a plant does not "remember" how much it grew at a particular time in the past.</li>
<li>This method only works with a fixed-step Euler solver.</li>
<li>If the model runs long enough, it will become oscillatory.</li>
</ul>
<h3><a class="anchor" id="autotoc_md44"></a>
Details of implementation</h3>
<p>In general, this model will be solved for a set of N time points <code>t_0</code>, <code>t_1</code>, ..., <code>t_{N-1}</code>. We can think of them as being labeled by an integer "index" i = 0, 1, ..., N-1. So, at each time point, this module stores the net rate of carbon assimilation due to photosynthesis in its <code>assim_rate_XXX_vec</code> members. When senescence begins for an organ, the senescence rate is determined from the 0th element of its associated <code>assim_rate_XXX_vec</code> vector. For the next timestep, element 1 is used. So on and so forth. This module uses the "senescence index" quantities to keep track of the index to use for senescence calculations.</p>
<p>Special care must be taken for the rhizome, since it may begin the simulation as a carbon source rather than a carbon sink. In this case, the 0th element of the <code>assim_rate_rhizome_vec</code> vector would not correspond to the rhizome's first timestep of growth. To account for this, the <code>rhizome_senescence_index</code> must be incremented while it is a carbon source. Then, when senescence kicks in later, the rhizome senescence index will refer to the first time point when the rhizome began to grow, rather than the first time point of the simulation.</p>
<p>Obviously this system is very fragile and requires some assumption about the behavior of the rhizome. Also, if any other organs ever act as carbon sources, they may not be handled properly.</p>
<h3><a class="anchor" id="autotoc_md45"></a>
Source</h3>
<p>The model represented by this module is not officially described anywhere, although it has been used for senescence in several published BioCro papers, such as the following:</p>
<ul>
<li>Miguez, F. E., Zhu, X., Humphries, S., Bollero, G. A. &amp; Long, S. P. "A semimechanistic model predicting the growth and production of the bioenergy crop Miscanthus×giganteus: description, parameterization and validation. <a href="https://doi.org/10.1111/j.1757-1707.2009.01019.x">GCB Bioenergy 1, 282–296 (2009)</a></li>
<li>Jaiswal, D. et al. Brazilian sugarcane ethanol as an expandable green alternative to crude oil use. <a href="https://doi.org/10.1038/nclimate3410">Nature Climate Change 7, 788–792 (2017)</a> </li>
</ul>

<p class="definition">Definition at line <a class="el" href="thermal__time__senescence_8hpp_source.html#l00089">89</a> of file <a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1cbddf8207e8b40e0a53bffc69a1f190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cbddf8207e8b40e0a53bffc69a1f190">&#9670;&nbsp;</a></span>thermal_time_senescence()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classthermal__time__senescence.html">thermal_time_senescence</a> </td>
          <td>(</td>
          <td class="paramtype">state_map const &amp;&#160;</td>
          <td class="paramname"><em>input_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">state_map *&#160;</td>
          <td class="paramname"><em>output_quantities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__senescence_8hpp_source.html#l00092">92</a> of file <a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abc6bcae9586eb99fffb12a684814a4e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6bcae9586eb99fffb12a684814a4e6">&#9670;&nbsp;</a></span>get_inputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string_vector get_inputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__senescence_8hpp_source.html#l00188">188</a> of file <a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>.</p>

</div>
</div>
<a id="ad0866265cb5b92692af7be0ef011f355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0866265cb5b92692af7be0ef011f355">&#9670;&nbsp;</a></span>get_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__senescence_8hpp_source.html#l00136">136</a> of file <a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>.</p>

</div>
</div>
<a id="a7eff545285286763183243b1d473e6df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eff545285286763183243b1d473e6df">&#9670;&nbsp;</a></span>get_outputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string_vector get_outputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__senescence_8hpp_source.html#l00212">212</a> of file <a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/github/workspace/src/module_library/<a class="el" href="thermal__time__senescence_8hpp_source.html">thermal_time_senescence.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classthermal__time__senescence.html">thermal_time_senescence</a></li>
    <li class="footer">Generated on Fri Nov 3 2023 01:28:43 for The BioCro C++ Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
