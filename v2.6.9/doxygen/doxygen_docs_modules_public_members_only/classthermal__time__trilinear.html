<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: thermal_time_trilinear Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classthermal__time__trilinear.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classthermal__time__trilinear-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">thermal_time_trilinear Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates the rate of thermal time accumulation using a trilinear model.  
 <a href="classthermal__time__trilinear.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for thermal_time_trilinear:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classthermal__time__trilinear__inherit__graph.png" border="0" usemap="#athermal__time__trilinear_inherit__map" alt="Inheritance graph"/></div>
<map name="athermal__time__trilinear_inherit__map" id="athermal__time__trilinear_inherit__map">
<area shape="rect" title="Calculates the rate of thermal time accumulation using a trilinear model." alt="" coords="5,80,152,107"/>
<area shape="rect" title=" " alt="" coords="13,5,144,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for thermal_time_trilinear:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classthermal__time__trilinear__coll__graph.png" border="0" usemap="#athermal__time__trilinear_coll__map" alt="Collaboration graph"/></div>
<map name="athermal__time__trilinear_coll__map" id="athermal__time__trilinear_coll__map">
<area shape="rect" title="Calculates the rate of thermal time accumulation using a trilinear model." alt="" coords="5,80,152,107"/>
<area shape="rect" title=" " alt="" coords="13,5,144,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae5ea43a1f618d3de99643fb8ff2a0f5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__trilinear.html#ae5ea43a1f618d3de99643fb8ff2a0f5a">thermal_time_trilinear</a> (state_map const &amp;input_quantities, state_map *output_quantities)</td></tr>
<tr class="separator:ae5ea43a1f618d3de99643fb8ff2a0f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:abc6bcae9586eb99fffb12a684814a4e6"><td class="memItemLeft" align="right" valign="top">static string_vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__trilinear.html#abc6bcae9586eb99fffb12a684814a4e6">get_inputs</a> ()</td></tr>
<tr class="separator:abc6bcae9586eb99fffb12a684814a4e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eff545285286763183243b1d473e6df"><td class="memItemLeft" align="right" valign="top">static string_vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__trilinear.html#a7eff545285286763183243b1d473e6df">get_outputs</a> ()</td></tr>
<tr class="separator:a7eff545285286763183243b1d473e6df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0866265cb5b92692af7be0ef011f355"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classthermal__time__trilinear.html#ad0866265cb5b92692af7be0ef011f355">get_name</a> ()</td></tr>
<tr class="separator:ad0866265cb5b92692af7be0ef011f355"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates the rate of thermal time accumulation using a trilinear model. </p>
<h3><a class="anchor" id="autotoc_md46"></a>
Model overview</h3>
<p>The thermal time <code>t_th</code> represents the accumulated exposure of a plant to temperatures within some acceptable range that allows the plant to develop. The time rate of change of <code>t_th</code> is often referred to as the development rate <code>DR</code>. For an overview of the different methods that can be used for calculating thermal time and its development rate, see the following references:</p>
<ul>
<li><a href="http://dx.doi.org/10.1007/978-1-4612-1626-1_2">Campbell, G. S. &amp; Norman, J. M. "Chapter 2: Temperature" in "An Introduction to Environmental Biophysics" (1998)</a></li>
<li><a href="http://dx.doi.org/10.1006/anbo.1999.0955">Yan, W. &amp; Hunt, L. A. "An Equation for Modelling the Temperature Response of Plants using only the Cardinal Temperatures" Ann Bot 84, 607–614 (1999)</a></li>
<li><a href="http://dx.doi.org/10.1007/978-1-4939-2493-6_384-3">McMaster, G. S. &amp; Moragues, M. "Crop Development Related to Temperature and Photoperiod" in "Encyclopedia of Sustainability Science and Technology" (2018)</a></li>
</ul>
<p>This module implements a piecewise linear model that includes a range of optimal temperatures in addition to base and maximum temperatures. Due to its shape, this model is sometimes called "trapezoidal." This model is implemented in several other crop growth simulators, e.g:</p>
<ul>
<li><code>CROPSIM</code>, described in <a href="http://dx.doi.org/10.4141/cjps95-107">Hunt, L. A. &amp; Pararajasingham, S. "CROPSIM — WHEAT: A model describing the growth and development of wheat." Can. J. Plant Sci. 75, 619–632 (1995)</a></li>
<li><code>CROPGRO</code>, described in <a href="http://dx.doi.org/10.2135/cropsci1996.0011183X003600060033x">Piper et al. "Comparison of Two Phenology Models for Predicting Flowering and Maturity Date of Soybean." Crop Science 36, 1606–1614 (1996)</a></li>
</ul>
<p>In this model, <code>DR</code> is determined from the air temperature <code>T</code> according to:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">DR   </th><th class="markdownTableHeadCenter">T range    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0</code>   </td><td class="markdownTableBodyCenter"><code>T &lt;= T_base</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>T - T_base</code>   </td><td class="markdownTableBodyCenter"><code>T_base &lt; T &lt;= T_opt_lower</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>T_opt_lower - T_base</code>   </td><td class="markdownTableBodyCenter"><code>T_opt_lower &lt; T &lt;= T_opt_upper</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>(T_max - T) * (T_opt_lower - T_base) / (T_max - T_opt_upper)</code>   </td><td class="markdownTableBodyCenter"><code>T_opt_upper &lt; T &lt;= T_max</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>0</code>   </td><td class="markdownTableBodyCenter"><code>T_max &lt; T</code>   </td></tr>
</table>
<p>Thermal time has units of <code>degrees C * day</code> and the development rate, as written here, has units of <code>degrees C * day / day = degrees C</code>. This is a common formulation, reflecting the fact that average daily temperatures are often used to calculate the increase in thermal time during an entire day.</p>
<p>This model is based on the observation that development rate is maximum at some optimum range of temperatures and decreases to zero at exceptionally low or high temperatures. It seems to be reasonably realistic for many plant species.</p>
<p>This model can be characterized as a piecewise linear model having four cardinal temperatures. If some of these temperatures are unavailable, other piecewise linear models are available that require fewer cardinal temperatures: <a class="el" href="classthermal__time__linear.html" title="Calculates the rate of thermal time accumulation using a linear model.">thermal_time_linear</a>, <a class="el" href="classthermal__time__linear__extended.html" title="Calculates the rate of thermal time accumulation using an extended linear model.">thermal_time_linear_extended</a>, and <a class="el" href="classthermal__time__bilinear.html" title="Calculates the rate of thermal time accumulation using a bilinear model.">thermal_time_bilinear</a>.</p>
<h3><a class="anchor" id="autotoc_md47"></a>
BioCro module implementation</h3>
<p>In BioCro, we use the following names for this model's parameters:</p><ul>
<li><code>'TTc'</code> for the thermal time <code>t_th</code></li>
<li><code>'temp'</code> for the air temperature <code>T</code></li>
<li><code>'tbase'</code> for the base temperature <code>T_base</code></li>
<li><code>'topt_lower'</code> for the lower optimal temperature <code>T_opt_lower</code></li>
<li><code>'topt_upper'</code> for the upper optimal temperature <code>T_opt_upper</code></li>
<li><code>'tmax'</code> for the maximum temperature <code>T_max</code></li>
</ul>
<p>Also note that time derivatives in BioCro are specified on a per hour basis, so a conversion factor of <code>24 hours per day</code> is required in the code as compared to the formulas presented above. </p>

<p class="definition">Definition at line <a class="el" href="thermal__time__trilinear_8h_source.html#l00084">84</a> of file <a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae5ea43a1f618d3de99643fb8ff2a0f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5ea43a1f618d3de99643fb8ff2a0f5a">&#9670;&nbsp;</a></span>thermal_time_trilinear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classthermal__time__trilinear.html">thermal_time_trilinear</a> </td>
          <td>(</td>
          <td class="paramtype">state_map const &amp;&#160;</td>
          <td class="paramname"><em>input_quantities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">state_map *&#160;</td>
          <td class="paramname"><em>output_quantities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__trilinear_8h_source.html#l00087">87</a> of file <a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abc6bcae9586eb99fffb12a684814a4e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6bcae9586eb99fffb12a684814a4e6">&#9670;&nbsp;</a></span>get_inputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string_vector get_inputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__trilinear_8h_source.html#l00126">126</a> of file <a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>.</p>

</div>
</div>
<a id="ad0866265cb5b92692af7be0ef011f355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0866265cb5b92692af7be0ef011f355">&#9670;&nbsp;</a></span>get_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__trilinear_8h_source.html#l00107">107</a> of file <a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>.</p>

</div>
</div>
<a id="a7eff545285286763183243b1d473e6df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eff545285286763183243b1d473e6df">&#9670;&nbsp;</a></span>get_outputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string_vector get_outputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="thermal__time__trilinear_8h_source.html#l00139">139</a> of file <a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/github/workspace/src/module_library/<a class="el" href="thermal__time__trilinear_8h_source.html">thermal_time_trilinear.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classthermal__time__trilinear.html">thermal_time_trilinear</a></li>
    <li class="footer">Generated on Fri Nov 3 2023 01:37:56 for The BioCro C++ Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
